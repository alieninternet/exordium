
DEFINES=
RM=@RM@
CXX=@CXX@
CXXFLAGS=@CXXFLAGS@
LDFLAGS=@LDFLAGS@
LIBS=@LIBS@

SOURCES=\
	channelgame.cpp \
	exordi8.cpp \
	module.cpp
	
INCDIRS=-I../../../include -I../../../../kineircd/include \
	-I../../../../kineircd/src/lib -I/usr/local/ssl/include -I.

OBJECTS=$(SOURCES:.cpp=.o)
ROBJECTS=cards/cards.o

TARGET=game.so

SUBDIRS=\
	cards

.PHONY: all $(SUB_DIRS)

all: all-recursive $(TARGET)

$(TARGET): $(OBJECTS)
	$(CXX) $(CXXFLAGS) $(LDFLAGS) -shared $(OBJECTS) $(ROBJECTS) -o $@ \
		-lservices -L../../lib

%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(LDFLAGS) $(DEFS) $(INCDIRS) -shared -c $<

clean: clean-recursive
	$(RM) *.o *~ $(TARGET)

distclean: distclean-recursive
	$(RM) *.o *~ $(TARGET) Makefile

pretty:
	indent *.cpp
	indent *.h
	$(RM) *~

all-recursive clean-recursive distclean-recursive:
	@target=`echo $@ | sed s/-recursive//`; \
	list='$(SUBDIRS)'; for subdir in $$list; do \
	      echo "Making $$target in $$subdir"; \
	      (cd $$subdir && $(MAKE) $$target) \
	      || exit 1; \
	done;
