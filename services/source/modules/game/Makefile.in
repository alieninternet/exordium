
DEFINES=
RM=@RM@
CXX=@CXX@
CXXFLAGS=@CXXFLAGS@
LDFLAGS=@LDFLAGS@
LIBS=@LIBS@

SOURCES=\
	channelgame.cpp \
	exordi8.cpp \
	module.cpp
	
INCDIRS=-I../../../include -I../../../../kineircd/include \
	-I../../../../kineircd/src/lib -I/usr/local/ssl/include -I.

OBJECTS=$(SOURCES:.cpp=.o)
ROBJECTS=cards/cards.o

TARGET=game.so

SUB_DIRS=\
	cards

.PHONY: all subdirs $(SUB_DIRS)

all: $(TARGET)

subdirs: $(SUB_DIRS)

$(SUB_DIRS):
	$(MAKE) -C $@

$(TARGET): subdirs $(OBJECTS)
	$(CXX) $(CXXFLAGS) $(LDFLAGS) -shared $(OBJECTS) $(ROBJECTS) -o $@ \
		-lservices -L../../lib

%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(LDFLAGS) $(DEFS) $(INCDIRS) -shared -c $<

clean:
	$(RM) *.o *~ $(TARGET)

distclean:
	$(RM) *.o *~ $(TARGET) Makefile

pretty:
	indent *.cpp
	indent *.h
	$(RM) *~
