DEFINES=@DEFS@
RM=@RM@
CXX=@CXX@
CXXFLAGS=@CXXFLAGS@
LDFLAGS=
LIBS=@LIBS@

SOURCES=main.cpp 
SOURCES_MODULE=module.cpp
INCLUDES=../include

OBJECTS=$(SOURCES:.cpp=.o)
OBJECTS_MODULE=$(SOURCES_MODULE:.cpp=.o)

TARGET=services
TARGET_MODULE=mod_exordium.so

all: $(TARGET_MODULE)

$(TARGET): $(OBJECTS)
	$(CXX) -o $@ $(OBJECTS) $(LIBS) -L/usr/local/mysql/lib/mysql $(LDFLAGS) lib/libservices.so

$(TARGET_MODULE): $(OBJECTS_MODULE)
	$(CXX) -o $@ $(OBJECTS_MODULE) $(LIBS) -L/usr/local/mysql/lib/mysql \
		$(LDFLAGS) lib/libservices.so \
		-fPIC -shared

%.o: %.cpp
	$(CXX) $(CXXFLAGS) $(DEFINES) -I$(INCLUDES) -I/usr/local/mysql/include/ -I../../kineircd/src/lib -I../../kineircd/include -I../include/  -c $< 


clean:
	$(RM) *.o *~ services *.log

distclean:
	$(RM) *.o *~ services *.log Makefile

pretty:
	indent *.cpp
	indent *.h
	$(RM) *~

modules:
	$(CXX) -I../include -I../../kineircd/include -I/usr/local/mysql/include -shared -o love.so love.cpp


