# This file is a part of Exordium Network Services - (c) 2002 IRCDome Development Team
# $Author$
# $Date$
# $Id$

SUBDIRS=source
AUTOGEN_SUB_DIRS=include src

########################################################################

.PHONY: all install clean distclean autogen dready sums distro fresh


# Make the package
all: all-recursive
#	for d in $(SUB_DIRS); \
#		do $(MAKE) -C $$d; \
#	done


clean: clean-recursive
	$(RM) *~ include/*~
#	for d in $(SUB_DIRS); \
#		do $(MAKE) -C $$d clean; \
#	done
#	$(RM) *~ include/*~

distclean: distclean-recursive
	$(RM) -r *~ include/*~ autom* config* Makefile
#	for d in $(SUB_DIRS); \
#		do $(MAKE) -C $$d distclean; \
#	done
	
dump:
	mysqldump --all --complete-insert -e --add-locks --delayed-insert --lock-tables services >db-dump.sql
	mysqldump --all --complete-insert -e --add-locks --delayed-insert --lock-tables --xml services >db-dump.xml
	gzip -v9 db-dump.sql
	gzip -v9 db-dump.xml
	
all-recursive clean-recursive distclean-recursive:
	@target=`echo $@ | sed s/-recursive//`; \
	list='$(SUBDIRS)'; for subdir in $$list; do \
	      echo "Making $$target in $$subdir"; \
	      (cd $$subdir && $(MAKE) $$target) \
	      || exit 1; \
	done;
